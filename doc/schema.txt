
2008-10-18, 16:49:22

unsupported atom 1.0 content elements:
- language attributes
- feed.contributor
- feed.generator
- feed.icon
- feed.link (we only extract exactly one URL, as implemented by UFP's feed.link)
- feed.logo
- feed.rights
- entry.contributor
- entry.link (we only extract exactly one URL)
- entry.rights
- entry.source
- any atom extensions

fields marked with [u] are updated on every request

 =========
 = feeds =
 =========

batchimports
- id
- last_modified not null
- feed_url unique not null
- import_successful not null default false
- fail_count not null default 0 [u] (incremented on fetch failures; reset to 0 on fetch success)

feeds
- id
- last_modified not null [u]

- active not null default true
- initial_url unique not null (the initial URL, may lead to redirects)
- actual_url unique not null (the URL after a permanent redirect)
- date_added not null (by feed fetcher)
- date_last_fetched not null [u]
- http_last_modified [u]
- http_etag [u]
- fail_count not null default 0 [u] (incremented on fetch failures; reset to 0 on fetch success)

- title not null [u] (for non-atom: if not provided in feed: set to initial feed link)
- description [u] (atom:subtitle, or rss:description)
- link not null [u] (provided by UFP: feed.link)
- unique_id [u] (atom:id, or ?? -> cannot change when feed changes location)
- ttl [u] (in seconds; rss:ttl, or ??? for atom)
- date_updated not null [u] (atom:updated)

entries
- id
- last_modified not null [u]

- date_added not null (by feed fetcher)

- feed_id not null
- unique_id unique not null (the atom:id, guid, or a generated uid; probably md5 (title, content, link))
- title not null [u] (for non-atom: if not provided in feed: set to initial entry link)
- content [u]
- summary [u]
- link not null [u] (provided by UFP: entries[i].link)
- date_published not null [u] (atom:published)
- date_updated not null [u] (atom:updated)

 ================
 = fetch errors =
 ================

error_types
- id
- last_modified not null
- name
- description

errors
- id
- last_modified not null
- error_type_id
- message
- payload

batchimports_errors
- id
- last_modified not null
- batchimport_id not null
- error_id not null

feeds_errors
- id
- last_modified not null
- feed_id not null
- error_id not null

 ===========
 = authors =
 ===========

authors
- id
- last_modified not null
- name not null
- email
- link
- unique: (name, email, link)

feeds_authors [u]
- id
- last_modified not null
- feed_id not null
- author_id not null

entries_authors [u]
- id
- last_modified not null
- entry_id not null
- author_id not null

 ==============
 = categories =
 ==============

categories
- id
- last_modified not null
- term not null (atom:term, or rss:category)
- scheme
- label

feeds_categories [u]
- id
- last_modified not null
- feed_id not null
- category_id not null

entries_categories [u]
- id
- last_modified not null
- entry_id not null
- category_id not null

 =========
 = users =
 =========

users
- id
- last_modified not null
- name not null
- password_hash not null
- email
- is_admin not null default false

feeds_users
- id
- last_modified not null
- user_id not null
- feed_id not null

 ========
 = tags =
 ========

tags
- id
- last_modified not null
- name not null

feeds_tags [u]
- id
- last_modified not null
- user_id not null
- feed_id not null
- tag_id not null

entries_tags [u]
- id
- last_modified not null
- user_id not null
- entry_id not null
- tag_id not null

 ====================
 = location aliases =
 ====================

-- to provide aliases, e.g. to map feedburner URLs to actual URLs
-- determined by keeping track of redirects while fetching a feed
feedurl_aliases
- id
- last_modified not null
- url unique not null
- feed_id not null

-- to provide aliases, e.g. to map feedburner URLs to actual URLs
-- determined by keeping track of redirects while prefetching an article URL
entryurl_aliases
- id
- last_modified not null
- url unique not null
- feed_id not null

